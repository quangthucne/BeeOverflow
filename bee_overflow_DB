-- Create the database
CREATE DATABASE bee_overflow;
USE bee_overflow;

-- Bảng Rank
CREATE TABLE rank (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    icon VARCHAR(255)
);

-- Bảng Account
CREATE TABLE account (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    fullname VARCHAR(255),
    email VARCHAR(255),
    avatar VARCHAR(255),
    phone VARCHAR(20),
    password VARCHAR(255),
    isActive BOOLEAN DEFAULT TRUE,
    role VARCHAR(50)
);

-- Bảng Reputation
CREATE TABLE reputation (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id INT,
    rank_id INT,
    point INT,
    FOREIGN KEY (account_id) REFERENCES account(id),
    FOREIGN KEY (rank_id) REFERENCES rank(id)
);

-- Bảng Questions
CREATE TABLE questions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id INT,
    title VARCHAR(255),
    content TEXT,
    detail TEXT,
    isDeleted BOOLEAN DEFAULT FALSE,
    isCheck BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (account_id) REFERENCES account(id)
);

-- Bảng Answer
CREATE TABLE answer (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id INT,
    ques_id INT,
    content TEXT,
    detail TEXT,
    isDeleted BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (account_id) REFERENCES account(id),
    FOREIGN KEY (ques_id) REFERENCES questions(id)
);

-- Bảng Question Vote
CREATE TABLE question_vote (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ques_id INT,
    count INT DEFAULT 0,
    FOREIGN KEY (ques_id) REFERENCES questions(id)
);

-- Bảng Answer Vote
CREATE TABLE ans_vote (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ans_id INT,
    count INT DEFAULT 0,
    FOREIGN KEY (ans_id) REFERENCES answer(id)
);

-- Bảng Tags
CREATE TABLE tags (
    id INT AUTO_INCREMENT PRIMARY KEY,
    question_id INT,
    name VARCHAR(100),
    FOREIGN KEY (question_id) REFERENCES questions(id)
);

-- Bảng Document Detail
CREATE TABLE document_detail (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name_doc VARCHAR(255),
    description TEXT,
    doc_src VARCHAR(255),
    price DECIMAL(10, 2),
    isDeleted BOOLEAN DEFAULT FALSE
);

-- Bảng Document
CREATE TABLE document (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id INT,
    doc_detail_id INT,
    FOREIGN KEY (account_id) REFERENCES account(id),
    FOREIGN KEY (doc_detail_id) REFERENCES document_detail(id)
);

-- Bảng Order
CREATE TABLE `order` (
    id INT AUTO_INCREMENT PRIMARY KEY,
    account_id INT,
    FOREIGN KEY (account_id) REFERENCES account(id)
);

-- Bảng Order Detail
CREATE TABLE order_detail (
    id INT AUTO_INCREMENT PRIMARY KEY,
    order_id INT,
    doc_id INT,
    price DECIMAL(10, 2),
    created_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (order_id) REFERENCES `order`(id),
    FOREIGN KEY (doc_id) REFERENCES document(id)
);
